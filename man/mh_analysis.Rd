% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/mh_fun.R
\name{mh_analysis}
\alias{mh_analysis}
\title{Mantel-Haenszel Analysis}
\usage{
mh_analysis(
  data,
  exposure,
  outcome,
  time = NULL,
  strata = NULL,
  measure = c("or", "irr"),
  conf.level = 0.95
)
}
\arguments{
\item{data}{A data frame containing the variables for analysis.}

\item{exposure}{Character string specifying the name of the exposure variable.}

\item{outcome}{Character string specifying the name of the outcome variable.
For odds ratio analysis (\code{measure = "or"}), this is the case/control
indicator. For rate ratio analysis (\code{measure = "irr"}), this is the
event/failure indicator.}

\item{time}{Character string specifying the name of the person-time variable.
Required when \code{measure = "irr"}. Ignored when \code{measure = "or"}.}

\item{strata}{Character string or vector specifying the stratification variable(s).
Optional for both measures (crude analysis if not provided).}

\item{measure}{Character string specifying the type of analysis: \code{"or"} for
odds ratio (default) or \code{"irr"} for incidence rate ratio.}

\item{conf.level}{Numeric value between 0 and 1 specifying the confidence level.
Default is 0.95 (95\% CI).}
}
\value{
Invisibly returns an object of class \code{"mh_analysis"} containing:
\describe{
\item{measure}{Character string describing the measure type.}
\item{estimate}{The pooled Mantel-Haenszel estimate.}
\item{ci}{Numeric vector of length 2 with confidence interval bounds.}
\item{se_ln}{Standard error of the log-transformed estimate.}
\item{test_stat}{Test statistic (homogeneity Q for stratified analyses).}
\item{test_name}{Name of the test performed.}
\item{test_df}{Degrees of freedom for the homogeneity test.}
\item{p_value}{P-value from the homogeneity test.}
\item{chi2}{Chi-squared test statistic for association.}
\item{chi2_p}{P-value for the association test.}
\item{conf.level}{The confidence level used.}
\item{strata_data}{Data frame with stratum-specific results.}
\item{call}{The matched function call.}
}
}
\description{
A unified interface for performing Mantel-Haenszel stratified analyses,
supporting both odds ratios and incidence rate ratios . This function provides a consistent interface and returns standardised output.
}
\details{
This function serves as a wrapper around \code{\link{mh_or}} and
\code{\link{stmh_r}}, providing a unified interface for both types of analysis.
The output is returned as an S3 object with a custom print method for clean
display.

For odds ratio analysis (\code{measure = "or"}):
\itemize{
\item \code{outcome} is the case/control indicator (required)
\item \code{strata} is optional (crude analysis if not provided)
\item \code{time} is ignored with a warning if provided
\item Uses \code{\link{mh_or}} internally
}

For rate ratio analysis (\code{measure = "irr"}):
\itemize{
\item \code{outcome} is the event/failure indicator (required)
\item \code{time} is required (person-time at risk)
\item \code{strata} is optional (crude analysis if not provided)
\item Uses \code{\link{stmh_r}} internally
}
}
\examples{
# Example for odds ratio analysis using lung cancer data
data(lung_cancer_cc)

or_result <- mh_analysis(lung_cancer_cc, exposure = "smoking", outcome = "case",
                         strata = "age_group", measure = "or")
print(or_result)

# Example for rate ratio analysis using mortality cohort data
data(mortality_cohort)

irr_result <- mh_analysis(mortality_cohort, exposure = "treatment", outcome = "death",
                          time = "person_years", strata = "severity", measure = "irr")
print(irr_result)

}
\seealso{
\code{\link{mh_or}} for direct odds ratio calculation,
\code{\link{stmh_r}} for direct rate ratio calculation,
\code{\link{print.mh_analysis}} for the print method.
}
